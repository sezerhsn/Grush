import { generateTypes } from "../generate-types.js";
export default async () => {
    const handlers = {
        async build(context, rootFilePaths, options, next) {
            const result = await next(context, rootFilePaths, options);
            // Skip if build failed (returned an error)
            if ("reason" in result) {
                return result;
            }
            // Skip for test scope (contracts only)
            if (options?.scope === "tests") {
                return result;
            }
            // Clear cache to ensure fresh data after compilation
            await context.artifacts.clearCache();
            // Get all artifact paths and generate types
            const allArtifactPaths = await context.artifacts.getAllArtifactPaths();
            await generateTypes(context.config.paths.root, context.config.typechain, context.globalOptions.noTypechain, Array.from(allArtifactPaths));
            return result;
        },
    };
    return handlers;
};
//# sourceMappingURL=solidity.js.map